{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-12-16T09:22:00.544290Z", "invocation_id": "94e05346-69c7-4139-beeb-0490821d4b95", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:42.822344Z", "completed_at": "2025-12-16T09:21:42.834345Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:42.836781Z", "completed_at": "2025-12-16T09:21:45.537338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7170157432556152, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c27a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.stg_contracts", "compiled": true, "compiled_code": "\n\n\nselect\naddress,\nblock_number,\nblock_timestamp,\nbytecode,\ndate,\nlast_modified\n\nfrom (select * from eth.eth_schema.contracts where false limit 0)", "relation_name": "DBT.DBT_DWEIGEL.stg_contracts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:45.544866Z", "completed_at": "2025-12-16T09:21:45.552412Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:45.552412Z", "completed_at": "2025-12-16T09:21:46.196231Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6523623466491699, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c27e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.stg_token_transfers", "compiled": true, "compiled_code": "\n\nselect\ntransaction_hash,\ndate,\ntoken_address,\nvalue\n\nfrom (select * from eth.eth_schema.token_transfers where false limit 0)", "relation_name": "DBT.DBT_DWEIGEL.stg_token_transfers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:46.204749Z", "completed_at": "2025-12-16T09:21:46.220308Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:46.221318Z", "completed_at": "2025-12-16T09:21:47.626672Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4239213466644287, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01c115f1-0207-df2c-0005-12a60006c296"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.eth.stg_transactions", "compiled": true, "compiled_code": "\n\nselect\nhash,\nblock_number,\ndate,\nfrom_address,\nto_address,\nvalue,\nreceipt_contract_address,\ninput\n\n\nfrom (select * from eth.eth_schema.transactions where false limit 0)\n\n\n\nwhere date >= (select max(date) from DBT.DBT_DWEIGEL.stg_transactions )\n\n", "relation_name": "DBT.DBT_DWEIGEL.stg_transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:47.633204Z", "completed_at": "2025-12-16T09:21:47.638195Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:47.638195Z", "completed_at": "2025-12-16T09:21:49.245439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6132335662841797, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c2aa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.stablecoin_activity_per_day.v1", "compiled": true, "compiled_code": "\n\nselect\nt.date,\nt.token_address,\ns.type,\ns.symbol,\n\n\n\nsum( t.value/power(10, s.decimals ) )\n as total_usd_value\n\nfrom (select * from DBT.DBT_DWEIGEL.stg_token_transfers where false limit 0) t \n\nleft join (select * from seeds.DBT_DWEIGEL_static.stablecoins where false limit 0) s\non t.token_address = s.contract_address\n\nwhere s.contract_address is not null\n\ngroup by \nt.date,\nt.token_address,\ns.type,\ns.symbol", "relation_name": "DBT.DBT_DWEIGEL_marts.stablecoin_activity_per_day_v1", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:49.254332Z", "completed_at": "2025-12-16T09:21:49.263356Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:49.263356Z", "completed_at": "2025-12-16T09:21:51.075885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8230669498443604, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c2ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.stablecoin_activity_per_day.v2", "compiled": true, "compiled_code": "\n\nselect\nt.date,\ns.type,\n\n\n\nsum( t.value/power(10, s.decimals ) )\n as total_usd_value\n\nfrom (select * from DBT.DBT_DWEIGEL.stg_token_transfers where false limit 0) t \n\nleft join (select * from seeds.DBT_DWEIGEL_static.stablecoins where false limit 0) s\non t.token_address = s.contract_address\n\nwhere s.contract_address is not null\n\ngroup by \nt.date,\ns.type", "relation_name": "DBT.DBT_DWEIGEL_marts.stablecoin_activity_per_day_v2", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:51.084476Z", "completed_at": "2025-12-16T09:21:51.093781Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:51.094781Z", "completed_at": "2025-12-16T09:21:51.845620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7621452808380127, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c2ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.token_activity_per_day", "compiled": true, "compiled_code": "\n\nselect\nt.date,\nt.token_address,\n\n\n\nsum( t.value/power(10, 18 ) )\n as total_value\n\nfrom (select * from DBT.DBT_DWEIGEL.stg_token_transfers where false limit 0) t \n\nwhere lower(t.token_address) = '0x514910771af9ca656af840dff83e8264ecf986ca'\n\ngroup by \nt.date,\nt.token_address", "relation_name": "DBT.DBT_DWEIGEL_marts.link_activity_per_day", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:51.854664Z", "completed_at": "2025-12-16T09:21:51.863196Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:51.864193Z", "completed_at": "2025-12-16T09:21:51.957370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10921406745910645, "adapter_response": {}, "message": "Database Error in model stg_transactions_enriched (models\\staging\\analytics\\stg_transactions_enriched.sql)\n  001003 (42000): SQL compilation error:\n  syntax error line 56 at position 0 unexpected 'select'.", "failures": null, "unique_id": "model.eth.stg_transactions_enriched", "compiled": true, "compiled_code": "\n\n\nWITH token_transfer_aggs AS (\n\nselect\ntransaction_hash,\ncount(*) as token_transfer_count\nfrom (select * from DBT.DBT_DWEIGEL.stg_token_transfers where false limit 0)\ngroup by transaction_hash\n\n),\n\ntransactions_enriched AS (\n\n\nselect\n\nt.hash,\nt.block_number,\nt.date,\nt.from_address,\nt.to_address,\nt.value,\nt.receipt_contract_address,\nt.input,\ntt.token_transfer_count,\n1 as new_field,\n\ncase\n    when t.receipt_contract_address != '' then 'contract_creation'\n    when tt.transaction_hash is not null then 'token_transfer'\n    when t.input = '0x' and t.value > 0 then 'plain_eth_transfer'\n    else 'other'\nend as transaction_category\n\nfrom (select * from DBT.DBT_DWEIGEL.stg_transactions where false limit 0) t\n\nleft join token_transfer_aggs tt\n\non t.hash = tt.transaction_hash\n\n\n\n\nwhere date >= (select max(date) from DBT.DBT_DWEIGEL.stg_transactions_enriched )\n\n\n\n)\n,\n\nselect\n*\nfrom transactions_enriched", "relation_name": "DBT.DBT_DWEIGEL.stg_transactions_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:51.972470Z", "completed_at": "2025-12-16T09:21:51.977466Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:51.978779Z", "completed_at": "2025-12-16T09:21:52.772584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8021218776702881, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c2f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.fiat_backed_activity_per_day", "compiled": true, "compiled_code": "select *\n\nfrom (select * from DBT.DBT_DWEIGEL_marts.stablecoin_activity_per_day_v2 where false limit 0)\n\nwhere type ='Fiat-backed'", "relation_name": "DBT.DBT_DWEIGEL_marts.fiat_backed_activity_per_day", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T09:21:52.780453Z", "completed_at": "2025-12-16T09:21:52.807257Z"}, {"name": "execute", "started_at": "2025-12-16T09:21:52.808263Z", "completed_at": "2025-12-16T09:22:00.176760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.398318767547607, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c115f1-0207-df2c-0005-12a60006c2f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.eth.python_model", "compiled": true, "compiled_code": "import holidays\r\n\r\ndef is_holiday(date_col):\r\n    # Chez Jaffle\r\n    french_holidays = holidays.France()\r\n    is_holiday = (date_col in french_holidays)\r\n    return is_holiday\r\n\r\ndef model(dbt, session):\r\n\r\n    dbt.config(packages=['holidays'])\r\n    my_sql_model_df = dbt.ref(\"stablecoin_activity_per_day\")\r\n\r\n    my_sql_model_df = my_sql_model_df.to_pandas()\r\n\r\n    my_sql_model_df[\"is_holiday\"] = my_sql_model_df[\"DATE\"].apply(is_holiday)\r\n\r\n\r\n\r\n    return my_sql_model_df\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {\"stablecoin_activity_per_day\": \"DBT.DBT_DWEIGEL_marts.stablecoin_activity_per_day_v2\"}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"DBT\"\n    schema = \"DBT_DWEIGEL_marts\"\n    identifier = \"python_model\"\n    \n    def __repr__(self):\n        return 'DBT.DBT_DWEIGEL_marts.python_model'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n\n", "relation_name": "DBT.DBT_DWEIGEL_marts.python_model", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.eth.confirmed_frauds", "compiled": false, "compiled_code": null, "relation_name": "DBT.DBT_DWEIGEL_marts.confirmed_frauds", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.eth.eth_activity_per_day", "compiled": false, "compiled_code": null, "relation_name": "DBT.DBT_DWEIGEL_marts.eth_activity_per_day", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.eth.stg_fraud", "compiled": false, "compiled_code": null, "relation_name": "DBT.DBT_DWEIGEL.stg_fraud", "batch_results": null}], "elapsed_time": 24.32267928123474, "args": {"state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": false, "require_resource_names_without_spaces": false, "use_colors_file": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "log_level_file": "debug", "favor_state": false, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "introspect": true, "print": true, "project_dir": "C:\\Users\\Daniel Weigel\\Documents\\Ethereum Project\\eth", "printer_width": 80, "macro_debugging": false, "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "log_level": "info", "log_format": "default", "defer": false, "exclude": [], "populate_cache": true, "invocation_command": "dbt run --empty", "log_file_max_bytes": 10485760, "select": [], "log_path": "C:\\Users\\Daniel Weigel\\Documents\\Ethereum Project\\eth\\logs", "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "C:\\Users\\Daniel Weigel\\.dbt", "vars": {}, "empty": true, "skip_nodes_if_on_run_start_fails": false, "strict_mode": false, "quiet": false, "which": "run", "indirect_selection": "eager", "cache_selected_only": false, "partial_parse": true, "partial_parse_file_diff": true, "version_check": true, "log_format_file": "debug", "show_resource_report": false, "use_colors": true}}